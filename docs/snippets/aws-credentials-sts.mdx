**Most secure method** - Uses temporary credentials that auto-rotate. No access keys to manage.

**What gets created**: A CloudFormation stack creates an IAM role with this policy:

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "iam:*",
                "s3:ListAllMyBuckets",
                "cloudwatch:*",
                "autoscaling:*",
                "application-autoscaling:*",
                "elasticloadbalancing:*",
                "organizations:DescribeAccount",
                "organizations:DescribeOrganization",
                "organizations:DescribeOrganizationalUnit",
                "organizations:DescribePolicy",
                "organizations:ListChildren",
                "organizations:ListParents",
                "organizations:ListPoliciesForTarget",
                "organizations:ListRoots",
                "organizations:ListPolicies",
                "organizations:ListTargetsForPolicy",
                "dynamodb:*",
                "ecr:*",
                "ec2:*",
                "elasticache:*",
                "cloudtrail:LookupEvents",
                "dynamodb:*",
                "tag:GetResources",
                "rds:*",
                "ecs:*",
                "eks:*",
                "logs:*",
                "events:DescribeRule",
                "events:DeleteRule",
                "events:ListRuleNamesByTarget",
                "events:ListTargetsByRule",
                "events:PutRule",
                "events:PutTargets",
                "es:AddTags",
                "es:RemoveTags",
                "es:ListTags",
                "es:DeleteElasticsearchDomain",
                "es:DescribeElasticsearchDomain",
                "es:CreateElasticsearchDomain",
                "events:RemoveTargets",
                "kms:*",
                "events:TagResource",
                "events:UntagResource",
                "events:ListTagsForResource"
            ],
            "Resource": "*"
        },
        {
            "Action": [
                "s3:*",
                "sqs:*"
            ],
            "Effect": "Allow",
            "Resource": [
                "arn:aws:s3:::qovery*",
                "arn:aws:s3:::qovery*/*",
                "arn:aws:sqs:*:*:qovery*",
                "arn:aws:sqs:*:*:qovery*/*"
            ]
        }
    ]
}
```

**Setup Steps**:

1. **Open CloudFormation**: Click this link to create the IAM role
   - [Launch CloudFormation Stack](https://console.aws.amazon.com/cloudformation/home?#/stacks/quickcreate?templateURL=https%3A%2F%2Fcloudformation-qovery-role-creation.s3.amazonaws.com%2Ftemplate.json&stackName=qovery-role-creation)
   - This opens AWS CloudFormation in a new tab (login to AWS if needed)

2. **In AWS CloudFormation Console**:
   - Click **Next** (template is pre-filled with Qovery's requirements)
   - Stack name: Keep default `qovery-iam-role` or customize
   - Click **Next** (skip stack options)
   - Click **Next** again (skip tags)
   - ✅ **Important**: Check **"I acknowledge that AWS CloudFormation might create IAM resources"**
   - Click **Create stack**

3. **Wait for completion** (~1 minute):
   - Status changes: `CREATE_IN_PROGRESS` → `CREATE_COMPLETE`
   - Refresh page if needed

4. **Get the Role ARN**:
   - Click on the **Outputs** tab
   - Find **RoleArn** key
   - Copy the value (looks like: `arn:aws:iam::123456789012:role/qovery-role`)

   <Frame>
     <img src="/images/aws-credentials/stack-output.png" alt="CloudFormation stack output with Role ARN" />
   </Frame>

5. **Complete in Qovery**:
   - Back in Qovery, paste the **Role ARN**
   - Give it a name like `AWS Production`
   - Click **Save**

   <Frame>
     <img src="/images/install-qovery/aws/create-credentials.png" alt="Enter Role ARN in Qovery Console" />
   </Frame>

<Tip>
**Why this is recommended**: The IAM role uses AWS STS (Security Token Service) to generate temporary credentials that automatically rotate. Qovery never has access to long-lived credentials, and you can revoke access instantly by deleting the CloudFormation stack.
</Tip>

<AccordionGroup>
  <Accordion title="What permissions does Qovery need?">
    Qovery requires these AWS permissions to manage your infrastructure:
    - **EC2**: Create VPCs, subnets, security groups, and instances
    - **EKS**: Create and manage Kubernetes clusters
    - **IAM**: Create service roles for EKS and EC2
    - **ELB**: Create load balancers for your applications
    - **S3**: Store Terraform state and logs
    - **CloudWatch**: Collect logs and metrics

    You can review the full CloudFormation template before creating the stack.
  </Accordion>

  <Accordion title="Can I use a custom IAM policy?">
    Yes! For production environments, you can create a custom IAM policy with minimum required permissions. Contact support for the minimal policy template.
  </Accordion>
</AccordionGroup>
